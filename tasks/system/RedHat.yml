---
<<<<<<< HEAD
- name: "Set elasticsearch version if defined"
=======
- name: Set elasticsearch version if defined
>>>>>>> master
  set_fact:
    es_package_name: '{{ es_package_name }}-{{ es_version }}'
  when: es_version.find('.x') == -1

- block:
<<<<<<< HEAD
    - name: "Importing latest logstash GPG Key"
=======
    - name: Importing latest logstash GPG Key
>>>>>>> master
      rpm_key:
        key: '{{ elastic_gpg_key }}'
        state: present
      register: installed_key
      until: installed_key is succeeded

    - name: Add elasticsearch yum repository
      yum_repository:
        name: elasticsearch
        description: Elasticsearch repository
        file: '{{ es_repo_file }}'
        baseurl: '{{ es_yum_url }}'
        gpgcheck: True
        gpgkey: '{{ elastic_gpg_key }}'
        enabled: True
        state: present

<<<<<<< HEAD
    - name: "Redhat - Installing Elasticsearch package"
=======
    - name: Redhat - Installing Elasticsearch package
>>>>>>> master
      yum:
        name: '{{ es_package_name }}'
        state: present
        update_cache: True
      register: installed_package
      until: installed_package is succeeded
      notify: Restart elasticsearch
  become: True

<<<<<<< HEAD
- name: "Checking selinux support"
=======
- name: Checking selinux support
>>>>>>> master
  include_tasks: selinux-support.yml
