---
# - name: "Add Elastic repo"
#   template:
#     src: "elasticsearch.repo"
#     dest: "/etc/yum.repos.d/elasticsearch-{{ es_major_version }}.repo"
#   become: True

- block:
    - name: "Importing latest logstash GPG Key"
      rpm_key:
        key: '{{ elastic_gpg_key }}'
        state: present


    - name: Add elasticsearch yum repository
      yum_repository:
        name: elasticsearch
        description: Elasticsearch repository
        file: elasticsearch
        baseurl: 'https://artifacts.elastic.co/packages/{{ es_major_version }}/yum'
        gpgcheck: True
        gpgkey: '{{ elastic_gpg_key }}'
        enabled: True
        state: present
  become: True

- name: "Set elasticsearch default file location"
  set_fact:
    es_default_file: '{{ es_default_file_redhat }}'

- name: "Checking selinux support"
  include_tasks: selinux-support.yml
